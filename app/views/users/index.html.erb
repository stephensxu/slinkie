<h1><%= render partial: "shared/header" %></h1>
<br>
<br>
<table>
  <col width="130">
  <col width="250">
  <col width="200">
  <col width="200">
  <col width="100">
  <col width="80">

  <thead>
    <tr>
      <th>Added</th>
      <th>Short URL</th>
      <th>URL</th>
      <th>Creator</th>
      <th>Clicks</th>
      <th>Visible by others?</th>
      <th colspan="3">Actions</th>
    </tr>
  </thead>

  <tbody>
    <% @links.each do |link| %>
      <% next if link.private && link.user != @current_user %>
      <tr>
        <td><%= time_ago_in_words(link.created_at) %> ago</td>
        <td><%= link_to(link_url(link), link) %></td>
        <td><%= link.url %></td>
        <td><%= user_display_name(link.user) %></td>
        <td><%= link.clicks_count %></td>
        <td>
          <% if link.editable_by?(@current_user) %>
              <%= button_to("#{link_visibility(link)}", patch_link_path(link), 
              :method => :patch, :params => { "link[private]" => "#{privacy_switch(link)}" }) %>
          <% end %>
        </td>
        <td>
          <% if link.editable_by?(@current_user) %>
            <ul class="link-actions">
              <li><%= link_to("Edit", edit_link_path(link)) %></li>
              <li><%= button_to("Delete", delete_link_path(link), :method => :delete) %></li>
            </ul> 
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<% if flash[:notice] %>
  <div id="notice">
    <strong><%= flash[:notice] %></strong>
  </div>
<% end %>


<%= link_to 'New Link', new_link_path %>
